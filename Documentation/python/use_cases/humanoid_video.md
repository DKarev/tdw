# `humanoid_video.py`

**Seth Alter
March 2020**

## Overview

Given a config file of [animations](../librarian/humanoid_animation_librarian.md) and [scenes](../librarian/scene_librarian.md) `humanoid_video.py` generates videos of each animation/scene/[humanoid](../../misc_frontend/humanoids.md) combination.

This controller was made for Martin Schrimpf and Sachi Sanghavi's "temporal" research.

![](images/humanoid_video.gif)

## Usage

1. `cd <root>/Python/use_cases/humanoid_video`
2. `python3 humanoid_video.py [ARGUMENTS]`
3. `<run build>`

#### Arguments

| Argument | Type | Default                  | Description      |
| -------- | ---- | ------------------------ | ---------------- |
| `--dir`  | str  | D:/humanoid_video_output | Output directory |

## How It Works

`humanoid_video.py` utilizes a config file located in the same directory to set up each animation: `animation_scene_matrix.json`. This file includes:

- Which animations can be played in which scenes (some animations cover too much distance for smaller scenes)
- Where the humanoid should initially be placed in the scene.

The controller then parses each valid animation/scene pair and generates a video per humanoid such that the total number of videos is: `number of humanoids * number of animation/scene combinations`.

Videos are generated by receiving [images](../../api/output_data.md) from the build and saving each set to a different directory. The images can be later stitched together into video with ffmpeg. If the animation runs faster than 30 FPS, the build will drop frames to create videos with the same framerate.

## `images_to_video.py`

`images_to_video.py` (located in the same directory as `humanoid_video.py`) is a simple script that repeatedly calls ffmpeg to convert each folder of images into .mp4 videos.

## Usage

1. (generate images with `humanoid_video.py`)
2. `python3 images_to_video.py [ARGUMENTS]`

#### Arguments

| Argument | Type | Default                  | Description      |
| -------- | ---- | ------------------------ | ---------------- |
| `--dir`  | str  | D:/humanoid_video_output | Source directory of images |

## Known Limitations

- Humanoids will clip through meshes, and can be occluded by walls or other props. For this reason, you can't simply add more scenes and animations to the script; for each scene/animation combination, you'll need to test whether the combination actually works at all and, if so, where the humanoid should be placed. This has to accordingly be updated in the `animation_scene_matrix.json` config file.
- Many of the animations have "missing" props such as chairs, mops, etc. This is a known limitation of the current implementation of humanoid animation in TDW.